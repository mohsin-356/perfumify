"use strict";(()=>{var e={};e.id=4831,e.ids=[4831,5679],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45937:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>y,patchFetch:()=>R,requestAsyncStorage:()=>g,routeModule:()=>_,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var r={};o.r(r),o.d(r,{DELETE:()=>p,GET:()=>c,PUT:()=>l});var n=o(73278),a=o(45002),s=o(54877),i=o(71309),u=o(48948),d=o(75679);async function c(e,{params:t}){try{await (0,u.u)();let e=await d.default.findById(t.id).populate("parent");if(!e)return i.NextResponse.json({error:"Category not found"},{status:404});return i.NextResponse.json(e)}catch(e){return i.NextResponse.json({error:"Failed to fetch category"},{status:500})}}async function l(e,{params:t}){try{await (0,u.u)();let o=await e.json(),r=await d.default.findByIdAndUpdate(t.id,o,{new:!0});if(!r)return i.NextResponse.json({error:"Category not found"},{status:404});return i.NextResponse.json(r)}catch(e){return i.NextResponse.json({error:"Failed to update category"},{status:500})}}async function p(e,{params:t}){try{if(await (0,u.u)(),!await d.default.findByIdAndDelete(t.id))return i.NextResponse.json({error:"Category not found"},{status:404});return i.NextResponse.json({message:"Category deleted successfully"})}catch(e){return i.NextResponse.json({error:"Failed to delete category"},{status:500})}}let _=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/categories/[id]/route",pathname:"/api/categories/[id]",filename:"route",bundlePath:"app/api/categories/[id]/route"},resolvedPagePath:"C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\src\\app\\api\\categories\\[id]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:m}=_,y="/api/categories/[id]/route";function R(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}},48948:(e,t,o)=>{o.d(t,{u:()=>s});var r=o(11185),n=o.n(r),a=o(61866);async function s(){let e=a.O.MONGODB_URI;if(n().connection?.readyState===1&&e)try{let t=e.match(/@([^/]+)/),o=t?.[1]||"",r=n().connection?.host||"";o&&r&&!r.includes(o)&&(await n().disconnect(),global._mongooseConnection=void 0)}catch{}if(!global._mongooseConnection){if(!a.O.MONGODB_URI)throw Error("MONGODB_URI is not defined in environment variables");let e=a.O.MONGODB_URI;global._mongooseConnection=n().connect(e,{autoIndex:!0}).catch(e=>{throw console.error("MongoDB connection failed:",e?.message),e})}return global._mongooseConnection}},61866:(e,t,o)=>{o.d(t,{O:()=>a});var r=o(13305);let n=r.Ryn({NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME:r.Z_8().min(1),NEXT_PUBLIC_CLOUDINARY_API_KEY:r.Z_8().min(1),NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET:r.Z_8().min(1).default("perfume_store"),CLOUDINARY_API_SECRET:r.Z_8().optional(),MONGODB_URI:r.Z_8().optional(),ADMIN_SECRET_TOKEN:r.Z_8().optional(),SMTP_HOST:r.Z_8().optional(),SMTP_PORT:r.oQ2.number().optional(),SMTP_USER:r.Z_8().optional(),SMTP_PASS:r.Z_8().optional(),NOTIFY_EMAIL:r.Z_8().optional()}).safeParse(process.env);if(!n.success)throw console.error("❌ Invalid environment variables:",n.error.flatten().fieldErrors),Error("Invalid environment variables – check .env");let a=n.success?n.data:{}},75679:(e,t,o)=>{o.r(t),o.d(t,{default:()=>s});var r=o(11185),n=o.n(r);let a=new(n()).Schema({name:{type:String,required:!0,trim:!0},slug:{type:String,required:!0,unique:!0,lowercase:!0},image:{url:String,public_id:String},description:{type:String},parent:{type:n().Schema.Types.ObjectId,ref:"Category",default:null}},{timestamps:!0}),s=n().models.Category||n().model("Category",a)}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[7787,3305,4833],()=>o(45937));module.exports=r})();