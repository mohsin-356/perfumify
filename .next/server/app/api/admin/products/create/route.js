"use strict";(()=>{var e={};e.id=9578,e.ids=[9578],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},21370:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>S,patchFetch:()=>f,requestAsyncStorage:()=>_,routeModule:()=>m,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{POST:()=>l,runtime:()=>c});var o=r(73278),a=r(45002),i=r(54877),s=r(71309),u=r(48948),p=r(1369),d=r(61866);let c="nodejs";async function l(e){if(e.headers.get("x-admin-token")!==d.O.ADMIN_SECRET_TOKEN)return s.NextResponse.json({error:"Unauthorized"},{status:401});let t=await e.json().catch(()=>null);if(!t)return s.NextResponse.json({error:"Invalid body"},{status:400});let{name:r,slug:n,description:o,price:a,images:i}=t;if(!r||!n||!a||!Array.isArray(i))return s.NextResponse.json({error:"name, slug, price, images[] are required"},{status:400});try{await (0,u.u)();let e=await p.x.create({name:r,slug:n,description:o,price:a,images:i});return s.NextResponse.json({product:e},{status:201})}catch(e){return console.error("Create product error",e),s.NextResponse.json({error:"Failed to create product",details:e?.message},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/products/create/route",pathname:"/api/admin/products/create",filename:"route",bundlePath:"app/api/admin/products/create/route"},resolvedPagePath:"C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\src\\app\\api\\admin\\products\\create\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:_,staticGenerationAsyncStorage:g,serverHooks:y}=m,S="/api/admin/products/create/route";function f(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},48948:(e,t,r)=>{r.d(t,{u:()=>i});var n=r(11185),o=r.n(n),a=r(61866);async function i(){let e=a.O.MONGODB_URI;if(o().connection?.readyState===1&&e)try{let t=e.match(/@([^/]+)/),r=t?.[1]||"",n=o().connection?.host||"";r&&n&&!n.includes(r)&&(await o().disconnect(),global._mongooseConnection=void 0)}catch{}if(!global._mongooseConnection){if(!a.O.MONGODB_URI)throw Error("MONGODB_URI is not defined in environment variables");let e=a.O.MONGODB_URI;global._mongooseConnection=o().connect(e,{autoIndex:!0}).catch(e=>{throw console.error("MongoDB connection failed:",e?.message),e})}return global._mongooseConnection}},61866:(e,t,r)=>{r.d(t,{O:()=>a});var n=r(13305);let o=n.Ryn({NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME:n.Z_8().min(1),NEXT_PUBLIC_CLOUDINARY_API_KEY:n.Z_8().min(1),NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET:n.Z_8().min(1).default("perfume_store"),CLOUDINARY_API_SECRET:n.Z_8().optional(),MONGODB_URI:n.Z_8().optional(),ADMIN_SECRET_TOKEN:n.Z_8().optional(),SMTP_HOST:n.Z_8().optional(),SMTP_PORT:n.oQ2.number().optional(),SMTP_USER:n.Z_8().optional(),SMTP_PASS:n.Z_8().optional(),NOTIFY_EMAIL:n.Z_8().optional()}).safeParse(process.env);if(!o.success)throw console.error("❌ Invalid environment variables:",o.error.flatten().fieldErrors),Error("Invalid environment variables – check .env");let a=o.success?o.data:{}},1369:(e,t,r)=>{r.d(t,{x:()=>s});var n=r(11185),o=r.n(n);let a=new n.Schema({url:{type:String,required:!0},public_id:{type:String,required:!0},width:{type:Number},height:{type:Number}},{_id:!1}),i=new n.Schema({name:{type:String,required:!0},slug:{type:String,required:!0,unique:!0},description:{type:String},shipping_policy:{type:String},refund_policy:{type:String},sale_price:{type:Number},price:{type:Number,required:!0},images:{type:[a],default:[]},category:{type:String,required:!0},categories:{type:[String],default:[]},brand:{type:String,required:!0},gender:{type:String,enum:["men","women","unisex"],default:"unisex"},stock:{type:Number,default:0},sku:{type:String,unique:!0,sparse:!0},weight:{type:Number},tags:[String],variations:Object,bestSeller:{type:Boolean,default:!1},newArrival:{type:Boolean,default:!1},featured:{type:Boolean,default:!1}},{timestamps:!0}),s=o().models.Product||o().model("Product",i)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[7787,3305,4833],()=>r(21370));module.exports=n})();