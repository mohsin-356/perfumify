(()=>{var e={};e.id=5505,e.ids=[5505],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},75615:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(31074),s(59964),s(53733),s(4521),s(90996);var r=s(30170),n=s(45002),a=s(83876),i=s.n(a),o=s(66299),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=["",{children:["admin",{children:["chats",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,31074)),"C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\src\\app\\admin\\chats\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,59964)),"C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\src\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,53733)),"C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,4521)),"C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\src\\app\\admin\\chats\\page.tsx"],m="/admin/chats/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/admin/chats/page",pathname:"/admin/chats",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},75324:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,34080,23))},14348:(e,t,s)=>{Promise.resolve().then(s.bind(s,51063))},34178:(e,t,s)=>{"use strict";var r=s(25289);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},51063:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(97247),n=s(28964),a=s(26529),i=s(29545),o=s(79906),l=s(34178),c=s(84180);let d=[{name:"Dashboard",href:"/admin/dashboard",icon:c.m6D},{name:"Products",href:"/admin/products",icon:c.Wpg},{name:"Categories",href:"/admin/categories",icon:c.aCJ},{name:"Brands",href:"/admin/brands",icon:c.E25},{name:"Orders",href:"/admin/orders",icon:c.x8h},{name:"Customers",href:"/admin/customers",icon:c.WY8},{name:"Leads",href:"/admin/leads",icon:c.zy7},{name:"Subscriptions",href:"/admin/subscriptions",icon:c.Imn},{name:"Reviews",href:"/admin/reviews",icon:c.nae},{name:"Chats",href:"/admin/chats",icon:c.IC0},{name:"Settings",href:"/admin/settings",icon:c.nbt}];function m(){let e=(0,l.usePathname)()??"";return(0,r.jsxs)("aside",{className:"w-64 bg-white border-r border-gray-200 min-h-screen flex flex-col fixed left-0 top-0 bottom-0 z-50",children:[r.jsx("div",{className:"h-16 flex items-center px-6 border-b border-gray-200",children:r.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Perfumify Admin"})}),r.jsx("nav",{className:"flex-1 overflow-y-auto py-4",children:r.jsx("ul",{className:"space-y-1 px-3",children:d.map(t=>{let s=e===t.href||e.startsWith(`${t.href}/`);return r.jsx("li",{children:(0,r.jsxs)(o.default,{href:t.href,className:`flex items-center px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${s?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[r.jsx(t.icon,{className:`mr-3 h-5 w-5 ${s?"text-gray-900":"text-gray-400"}`}),t.name]})},t.name)})})}),r.jsx("div",{className:"p-4 border-t border-gray-200",children:(0,r.jsxs)("button",{className:"flex items-center w-full px-3 py-2.5 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[r.jsx(c.xqh,{className:"mr-3 h-5 w-5 text-gray-400"}),"Logout"]})})]})}function u(){return(0,r.jsxs)("header",{className:"h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6 sticky top-0 z-40 ml-64",children:[r.jsx("div",{className:"flex items-center w-96",children:(0,r.jsxs)("div",{className:"relative w-full",children:[r.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(c.jRj,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-gray-50 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Search..."})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("button",{className:"p-2 text-gray-400 hover:text-gray-500 relative",children:[r.jsx(c.vWP,{className:"h-6 w-6"}),r.jsx("span",{className:"absolute top-1.5 right-1.5 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold",children:"A"}),r.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Admin User"})]})]})]})}function h({children:e}){return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 font-sans",children:[r.jsx(m,{}),r.jsx(u,{}),r.jsx("main",{className:"ml-64 p-8",children:e})]})}function x({children:e}){let t=(0,n.useRef)();return t.current||(t.current=new a.QueryClient({defaultOptions:{queries:{staleTime:3e5,cacheTime:6e5,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:1}}})),r.jsx(a.QueryClientProvider,{client:t.current,children:r.jsx(i.DA,{children:r.jsx(h,{children:e})})})}},92349:(e,t,s)=>{"use strict";s.d(t,{default:()=>n.a});var r=s(53160),n=s.n(r)},53160:(e,t,s)=>{"use strict";let{createProxy:r}=s(45347);e.exports=r("C:\\Users\\SMART TECH\\Desktop\\perfumeStore\\node_modules\\next\\dist\\client\\link.js")},31074:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c,dynamic:()=>o});var r=s(72051),n=s(48948),a=s(29322),i=s(92349);let o="force-dynamic";async function l(){return await (0,n.u)(),JSON.parse(JSON.stringify(await a.e.find().sort({lastMessageAt:-1}).select("clientName clientEmail status lastMessageAt").lean()))}async function c(){let e=await l();return(0,r.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Chats"}),r.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Incoming customer chats and their latest activity."})]}),r.jsx("div",{className:"bg-white rounded-xl border",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 text-left",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"p-3",children:"Customer"}),r.jsx("th",{className:"p-3",children:"Email"}),r.jsx("th",{className:"p-3",children:"Status"}),r.jsx("th",{className:"p-3",children:"Last message"}),r.jsx("th",{className:"p-3"})]})}),(0,r.jsxs)("tbody",{children:[e.map(e=>(0,r.jsxs)("tr",{className:"border-t",children:[r.jsx("td",{className:"p-3",children:e.clientName||"Visitor"}),r.jsx("td",{className:"p-3",children:e.clientEmail||"-"}),r.jsx("td",{className:"p-3 capitalize",children:e.status}),r.jsx("td",{className:"p-3",children:new Date(e.lastMessageAt).toLocaleString()}),r.jsx("td",{className:"p-3 text-right",children:r.jsx(i.default,{href:`/admin/chats/${e._id}`,className:"text-indigo-600 hover:underline",children:"Open"})})]},e._id)),0===e.length&&r.jsx("tr",{children:r.jsx("td",{className:"p-6 text-center text-gray-500",colSpan:5,children:"No chats yet"})})]})]})})]})}},59964:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(45347).createProxy)(String.raw`C:\Users\SMART TECH\Desktop\perfumeStore\src\app\admin\layout.tsx#default`)},48948:(e,t,s)=>{"use strict";s.d(t,{u:()=>i});var r=s(11185),n=s.n(r),a=s(61866);async function i(){let e=a.O.MONGODB_URI;if(n().connection?.readyState===1&&e)try{let t=e.match(/@([^/]+)/),s=t?.[1]||"",r=n().connection?.host||"";s&&r&&!r.includes(s)&&(await n().disconnect(),global._mongooseConnection=void 0)}catch{}if(!global._mongooseConnection){if(!a.O.MONGODB_URI)throw Error("MONGODB_URI is not defined in environment variables");let e=a.O.MONGODB_URI;global._mongooseConnection=n().connect(e,{autoIndex:!0}).catch(e=>{throw console.error("MongoDB connection failed:",e?.message),e})}return global._mongooseConnection}},61866:(e,t,s)=>{"use strict";s.d(t,{O:()=>a});var r=s(13305);let n=r.Ryn({NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME:r.Z_8().min(1),NEXT_PUBLIC_CLOUDINARY_API_KEY:r.Z_8().min(1),NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET:r.Z_8().min(1).default("perfume_store"),CLOUDINARY_API_SECRET:r.Z_8().optional(),MONGODB_URI:r.Z_8().optional(),ADMIN_SECRET_TOKEN:r.Z_8().optional(),SMTP_HOST:r.Z_8().optional(),SMTP_PORT:r.oQ2.number().optional(),SMTP_USER:r.Z_8().optional(),SMTP_PASS:r.Z_8().optional(),NOTIFY_EMAIL:r.Z_8().optional()}).safeParse(process.env);if(!n.success)throw console.error("❌ Invalid environment variables:",n.error.flatten().fieldErrors),Error("Invalid environment variables – check .env");let a=n.success?n.data:{}},29322:(e,t,s)=>{"use strict";s.d(t,{e:()=>o});var r=s(11185),n=s.n(r);let a=new r.Schema({sender:{type:String,enum:["client","admin"],required:!0},text:{type:String,required:!0},createdAt:{type:Date,default:Date.now},read:{type:Boolean,default:!1}},{_id:!1}),i=new r.Schema({clientId:{type:String,required:!0,index:!0},clientName:{type:String},clientEmail:{type:String},status:{type:String,enum:["open","closed"],default:"open"},lastMessageAt:{type:Date,default:Date.now,index:!0},messages:{type:[a],default:[]}},{timestamps:!0}),o=n().models.Chat||n().model("Chat",i)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[7787,3305,8131,3801,826],()=>s(75615));module.exports=r})();