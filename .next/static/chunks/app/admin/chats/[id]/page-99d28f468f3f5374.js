(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4155],{71186:function(e,t,n){Promise.resolve().then(n.t.bind(n,72972,23)),Promise.resolve().then(n.bind(n,22463))},22463:function(e,t,n){"use strict";n.d(t,{default:function(){return c}});var a=n(57437),s=n(2265),r=n(68680);function c(e){let{chatId:t,initial:n}=e,[c,i]=(0,s.useState)(n||[]),[o,d]=(0,s.useState)(""),l=(0,s.useRef)(null),u=(0,s.useRef)("");async function h(){let e=o.trim();e&&(d(""),i(t=>[...t,{sender:"admin",text:e,createdAt:new Date().toISOString()}]),await fetch("/api/admin/chats/".concat(t,"/reply"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}).catch(()=>{}))}return(0,s.useEffect)(()=>{fetch("/api/socket").catch(()=>{});let e=(0,r.io)({path:"/api/socket_io"});return l.current=e,e.on("connect",()=>{e.emit("join",t)}),e.on("message",e=>{if(e.chatId!==t)return;let n="".concat(e.sender,"|").concat(e.text),a=c[c.length-1];n!==(a?"".concat(a.sender,"|").concat(a.text):"")&&n!==u.current&&(u.current=n,i(t=>[...t,{sender:e.sender,text:e.text,createdAt:new Date().toISOString()}]))}),()=>{e.disconnect()}},[t]),(0,a.jsxs)("div",{className:"bg-white rounded-xl border overflow-hidden",children:[(0,a.jsx)("div",{className:"h-[60vh] overflow-y-auto p-4 space-y-2 bg-gray-50",children:c.map((e,t)=>(0,a.jsx)("div",{className:"flex ".concat("admin"===e.sender?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:"".concat("admin"===e.sender?"bg-indigo-600 text-white":"bg-white text-gray-800"," px-3 py-2 rounded-lg max-w-[75%] shadow"),children:e.text})},t))}),(0,a.jsxs)("div",{className:"border-t p-3 flex gap-2",children:[(0,a.jsx)("input",{className:"flex-1 border rounded-md px-3 py-2 text-sm",placeholder:"Type your reply",value:o,onChange:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&h()}),(0,a.jsx)("button",{onClick:h,className:"bg-indigo-600 text-white rounded-md px-4 text-sm",children:"Reply"})]})]})}}},function(e){e.O(0,[2972,8680,2971,2117,1744],function(){return e(e.s=71186)}),_N_E=e.O()}]);