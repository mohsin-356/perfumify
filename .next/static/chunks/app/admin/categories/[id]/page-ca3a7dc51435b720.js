(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5375,588],{46293:function(e,t,a){Promise.resolve().then(a.bind(a,20911))},33145:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var r=a(48461),s=a.n(r)},99376:function(e,t,a){"use strict";var r=a(35475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},48461:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return l},getImageProps:function(){return i}});let r=a(47043),s=a(55346),n=a(65878),o=r._(a(5084));function i(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let l=n.Image},25523:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return r}});let r=a(47043)._(a(2265)).default.createContext(null)},20911:function(e,t,a){"use strict";a.d(t,{default:function(){return c}});var r=a(57437),s=a(2265),n=a(99376),o=a(29501),i=a(21469),l=a(83626);function c(e){let{initialData:t,categories:a}=e,c=(0,n.useRouter)(),[d,u]=(0,s.useState)(!1),[p,m]=(0,s.useState)((null==t?void 0:t.image)||null),[f,g]=(0,s.useState)(!1),{register:h,handleSubmit:x,formState:{errors:b}}=(0,o.cI)({defaultValues:t||{}}),y=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;g(!0);let r=new FormData;r.append("file",a);try{let e=await fetch("/api/upload",{method:"POST",body:r}),t=await e.json();if(!e.ok)throw Error(t.error||"Image upload failed");(t.secure_url||t.url)&&m({url:t.secure_url||t.url,public_id:t.public_id})}catch(e){console.error("Upload failed",e),alert("Image upload failed")}finally{g(!1)}},j=async e=>{u(!0);try{let a={...e,image:p,parent:e.parent||null},r=t?"/api/categories/".concat(t._id):"/api/categories";if(!(await fetch(r,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw Error("Failed to save category");c.push("/admin/categories"),c.refresh()}catch(e){console.error(e),alert("Failed to save category")}finally{u(!1)}};return(0,r.jsxs)("form",{onSubmit:x(j),className:"space-y-8 bg-white p-8 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Category Name"}),(0,r.jsx)("input",{...h("name",{required:"Name is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g. Men's Perfume"}),b.name&&(0,r.jsx)("p",{className:"text-red-500 text-xs",children:b.name.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Parent Category"}),(0,r.jsxs)("select",{...h("parent"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white",children:[(0,r.jsx)("option",{value:"",children:"None (Top Level)"}),a.filter(e=>e._id!==(null==t?void 0:t._id)).map(e=>(0,r.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{...h("description"),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Category description..."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Image"}),(0,r.jsx)("div",{className:"flex items-center gap-4",children:p?(0,r.jsxs)("div",{className:"relative h-24 w-24 rounded-lg overflow-hidden border border-gray-200 group",children:[(0,r.jsx)(l.Z,{publicId:p.public_id,alt:"Category Image",width:96,height:96,className:"object-cover h-full w-full"}),(0,r.jsx)("button",{type:"button",onClick:()=>m(null),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,r.jsx)(i.q5L,{className:"h-3 w-3"})})]}):(0,r.jsxs)("label",{className:"h-24 w-24 flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 hover:bg-indigo-50 transition-all",children:[f?(0,r.jsx)(i.dAq,{className:"h-6 w-6 text-indigo-600 animate-spin"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Yjd,{className:"h-6 w-6 text-gray-400"}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Upload"})]}),(0,r.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:y,disabled:f})]})})]})]}),(0,r.jsxs)("div",{className:"flex justify-end pt-6 border-t border-gray-100",children:[(0,r.jsx)("button",{type:"button",onClick:()=>c.back(),className:"mr-4 px-6 py-2.5 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors font-medium",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",disabled:d||f,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors font-medium flex items-center gap-2",children:[d&&(0,r.jsx)(i.dAq,{className:"animate-spin"}),d?"Saving...":t?"Update Category":"Create Category"]})]})]})}},83626:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var r=a(57437),s=a(33145);let n="dqzpqza20";function o(e,t){let{width:a,height:r,crop:s="fill",blur:o,quality:i="auto",format:l="auto"}=t;if(!n)return"";let c=[];s&&c.push("c_".concat(s)),a&&c.push("w_".concat(a)),r&&c.push("h_".concat(r)),i&&c.push("q_".concat(i)),l&&c.push("f_".concat(l)),o&&c.push("e_blur:".concat(o));let d=c.join(",");return"https://res.cloudinary.com/".concat(n,"/image/upload/").concat(d,"/").concat(e)}var i=e=>{let{publicId:t,alt:a,width:n,height:i,sizes:l="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 400px",className:c,crop:d="fill"}=e,u=o(t,{width:n,height:i,crop:d,quality:"auto",format:"auto"}),p=o(t,{width:20,height:20,crop:d,blur:200,quality:"auto",format:"auto"});return(0,r.jsx)(s.default,{src:u,alt:a,width:n,height:i,sizes:l,className:c,placeholder:"blur",blurDataURL:p,loading:"lazy"})}}},function(e){e.O(0,[2502,5878,3587,2971,2117,1744],function(){return e(e.s=46293)}),_N_E=e.O()}]);