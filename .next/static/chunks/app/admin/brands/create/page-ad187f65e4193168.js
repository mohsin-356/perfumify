(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8522,7666],{44895:function(e,t,a){Promise.resolve().then(a.bind(a,75404))},33145:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var r=a(48461),n=a.n(r)},99376:function(e,t,a){"use strict";var r=a(35475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},48461:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return l},getImageProps:function(){return i}});let r=a(47043),n=a(55346),s=a(65878),o=r._(a(5084));function i(e){let{props:t}=(0,n.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let l=s.Image},25523:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return r}});let r=a(47043)._(a(2265)).default.createContext(null)},75404:function(e,t,a){"use strict";a.d(t,{default:function(){return d}});var r=a(57437),n=a(2265),s=a(99376),o=a(29501),i=a(21469),l=a(83626);function d(e){let{initialData:t}=e,a=(0,s.useRouter)(),[d,c]=(0,n.useState)(!1),[u,f]=(0,n.useState)((null==t?void 0:t.image)||null),[p,m]=(0,n.useState)(!1),{register:h,handleSubmit:g,formState:{errors:b}}=(0,o.cI)({defaultValues:t||{}}),x=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;m(!0);let r=new FormData;r.append("file",a);try{let e=await fetch("/api/upload",{method:"POST",body:r}),t=await e.json();if(!e.ok)throw Error(t.error||"Image upload failed");(t.secure_url||t.url)&&f({url:t.secure_url||t.url,public_id:t.public_id})}catch(e){console.error("Upload failed",e),alert("Image upload failed")}finally{m(!1)}},y=async e=>{c(!0);try{let r={...e,image:u},n=t?"/api/brands/".concat(t._id):"/api/brands";if(!(await fetch(n,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw Error("Failed to save brand");a.push("/admin/brands"),a.refresh()}catch(e){console.error(e),alert("Failed to save brand")}finally{c(!1)}};return(0,r.jsxs)("form",{onSubmit:g(y),className:"space-y-8 bg-white p-8 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Brand Name"}),(0,r.jsx)("input",{...h("name",{required:"Name is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g. Gucci"}),b.name&&(0,r.jsx)("p",{className:"text-red-500 text-xs",children:b.name.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{...h("description"),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Brand description..."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Logo"}),(0,r.jsx)("div",{className:"flex items-center gap-4",children:u?(0,r.jsxs)("div",{className:"relative h-24 w-24 rounded-lg overflow-hidden border border-gray-200 group",children:[(0,r.jsx)(l.Z,{publicId:u.public_id,alt:"Brand Logo",width:96,height:96,className:"object-cover h-full w-full"}),(0,r.jsx)("button",{type:"button",onClick:()=>f(null),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,r.jsx)(i.q5L,{className:"h-3 w-3"})})]}):(0,r.jsxs)("label",{className:"h-24 w-24 flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 hover:bg-indigo-50 transition-all",children:[p?(0,r.jsx)(i.dAq,{className:"h-6 w-6 text-indigo-600 animate-spin"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Yjd,{className:"h-6 w-6 text-gray-400"}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Upload"})]}),(0,r.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:x,disabled:p})]})})]})]}),(0,r.jsxs)("div",{className:"flex justify-end pt-6 border-t border-gray-100",children:[(0,r.jsx)("button",{type:"button",onClick:()=>a.back(),className:"mr-4 px-6 py-2.5 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors font-medium",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",disabled:d||p,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors font-medium flex items-center gap-2",children:[d&&(0,r.jsx)(i.dAq,{className:"animate-spin"}),d?"Saving...":t?"Update Brand":"Create Brand"]})]})]})}},83626:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var r=a(57437),n=a(33145);let s="dqzpqza20";function o(e,t){let{width:a,height:r,crop:n="fill",blur:o,quality:i="auto",format:l="auto"}=t;if(!s)return"";let d=[];n&&d.push("c_".concat(n)),a&&d.push("w_".concat(a)),r&&d.push("h_".concat(r)),i&&d.push("q_".concat(i)),l&&d.push("f_".concat(l)),o&&d.push("e_blur:".concat(o));let c=d.join(",");return"https://res.cloudinary.com/".concat(s,"/image/upload/").concat(c,"/").concat(e)}var i=e=>{let{publicId:t,alt:a,width:s,height:i,sizes:l="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 400px",className:d,crop:c="fill"}=e,u=o(t,{width:s,height:i,crop:c,quality:"auto",format:"auto"}),f=o(t,{width:20,height:20,crop:c,blur:200,quality:"auto",format:"auto"});return(0,r.jsx)(n.default,{src:u,alt:a,width:s,height:i,sizes:l,className:d,placeholder:"blur",blurDataURL:f,loading:"lazy"})}}},function(e){e.O(0,[2502,5878,3587,2971,2117,1744],function(){return e(e.s=44895)}),_N_E=e.O()}]);